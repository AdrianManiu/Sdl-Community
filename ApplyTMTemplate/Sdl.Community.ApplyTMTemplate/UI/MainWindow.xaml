<controls:MetroWindow x:Class="Sdl.Community.ApplyTMTemplate.UI.MainWindow"
					  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
		              xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
					  xmlns:utilities="clr-namespace:Sdl.Community.ApplyTMTemplate.Utilities"
			          xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
				      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
					  xmlns:controls="http://metro.mahapps.com/winfx/xaml/controls"
					  xmlns:Dialog="clr-namespace:MahApps.Metro.Controls.Dialogs;assembly=MahApps.Metro"
					  Dialog:DialogParticipation.Register="{Binding}"
					  xmlns:converters="clr-namespace:Sdl.Community.ApplyTMTemplate.Converters"
					  xmlns:applyTmTemplate="clr-namespace:Sdl.Community.ApplyTMTemplate"
					  xmlns:ui="clr-namespace:Sdl.Community.ApplyTMTemplate.UI"
					  xmlns:viewModels="clr-namespace:Sdl.Community.ApplyTMTemplate.ViewModels"
					  WindowStartupLocation="CenterScreen"
					  TitleCharacterCasing="Normal"
		              mc:Ignorable="d"
				 	  GlowBrush="#0C2D47"
					  FontFamily="Calibri"
					  WindowTitleBrush="#008264"
					  Title="Apply TM Template" Width="{Binding Source={x:Static SystemParameters.PrimaryScreenWidth}, Converter={converters:RatioConverter}, ConverterParameter='0.48'}" Height="{Binding Source={x:Static SystemParameters.PrimaryScreenHeight}, Converter={converters:RatioConverter}, ConverterParameter='0.7'}" MinWidth="{Binding Source={x:Static SystemParameters.PrimaryScreenWidth}, Converter={converters:RatioConverter}, ConverterParameter='0.48'}" MinHeight="{Binding Source={x:Static SystemParameters.PrimaryScreenHeight}, Converter={converters:RatioConverter}, ConverterParameter='0.61'}">

	<Window.Resources>
		<ResourceDictionary>
			<ResourceDictionary.MergedDictionaries>
				<ResourceDictionary Source="../UiHelpers/MetroStyle.xaml" />
				<ResourceDictionary Source="../UiHelpers/ButtonsStyle.xaml" />
				<ResourceDictionary Source="../UiHelpers/TextBlockStyle.xaml" />
				<ResourceDictionary Source="../UiHelpers/TextBoxStyle.xaml" />
				<ResourceDictionary Source="../UiHelpers/DataGridStyle.xaml"/>
				<ResourceDictionary Source="../UiHelpers/DataGridStyle2.xaml"/>
				<ResourceDictionary Source="../UiHelpers/Buttons.xaml" />
			</ResourceDictionary.MergedDictionaries>
			<Style TargetType="Button" x:Key="SdlWizardStyleButton" BasedOn="{StaticResource SdlSecondaryButtonStyle}">
				<Setter Property="MinWidth" Value="70"></Setter>
				<Setter Property="Height" Value="34"></Setter>
				<Setter Property="Margin" Value="5,9,5,11"></Setter>
			</Style>
			<Style TargetType="Button" x:Key="SdlWizardStyleButtonGreen" BasedOn="{StaticResource SdlPrimaryButtonStyle}">
				<Setter Property="MinWidth" Value="70"></Setter>
				<Setter Property="Height" Value="34"></Setter>
				<Setter Property="Margin" Value="5,9,5,11"></Setter>
			</Style>

			<DataTemplate DataType="{x:Type viewModels:TimedTextBox}">
				<ui:TimedTextBox />
			</DataTemplate>
		</ResourceDictionary>
	</Window.Resources>

	<Grid>
		<Grid.ColumnDefinitions>
			<ColumnDefinition />
			<ColumnDefinition />
		</Grid.ColumnDefinitions>

		<Grid.RowDefinitions>
			<RowDefinition Height="Auto" />
			<RowDefinition Height="Auto" />
			<RowDefinition Height="Auto" />
			<RowDefinition Height="Auto" />
			<RowDefinition Height="*" />
			<RowDefinition Height="Auto" />
		</Grid.RowDefinitions>

		<TextBlock FontWeight="Bold" FontSize="13" Grid.Row="0" HorizontalAlignment="Left" TextWrapping="Wrap" Text="Select the template to be used: " VerticalAlignment="Top" Margin="10,10,0,0"  Grid.ColumnSpan="3" />

		<DockPanel Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" Margin="5,0,0,0">
			<TextBlock DockPanel.Dock="Bottom" Margin="0,22,10,0" HorizontalAlignment="Right"
			           IsEnabled="{Binding CanExecuteExport, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
			           ToolTip="{x:Static applyTmTemplate:PluginResources.Export_button_Tooltip}">
				<TextBlock.Style>
					<Style TargetType="TextBlock">
						<Style.Triggers>
							<DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsEnabled}" Value="False">
								<Setter Property="Visibility" Value="Collapsed" />
							</DataTrigger>
							<DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsEnabled}" Value="True">
								<Setter Property="Visibility" Value="Visible" />
							</DataTrigger>
						</Style.Triggers>
					</Style>
				</TextBlock.Style>
				<Hyperlink TextDecorations="UnderLine" Command="{Binding ExportCommand}">Export to excel...
						<Hyperlink.Style>
							<Style TargetType="Hyperlink"
							       BasedOn="{StaticResource {x:Type Hyperlink}}">
								<Setter Property="Foreground" Value="#0C0" />
							</Style>
						</Hyperlink.Style>
					</Hyperlink>
			</TextBlock>
			<ui:TimedTextBox Height="32" Content="{Binding TimedTextBoxViewModel}" Margin="0,0,10,0"></ui:TimedTextBox>
		</DockPanel>

		<StackPanel Grid.Row="2" Grid.Column="0" Margin="10,10,0,0">
			<TextBlock Text="What to apply:" />
			<CheckBox IsChecked="{Binding VariablesChecked}" Content="Variables" Margin="10,15,0,0" FontFamily="Calibri"/>
			<CheckBox IsChecked="{Binding AbbreviationsChecked}" Content="Abbreviations" Margin="10,10,0,0" FontFamily="Calibri"/>
			<CheckBox IsChecked="{Binding OrdinalFollowersChecked}" Content="Ordinal followers" Margin="10,10,0,0" FontFamily="Calibri"/>
			<CheckBox IsChecked="{Binding SegmentationRulesChecked}" Content="Segmentation rules" Margin="10,10,0,0" FontFamily="Calibri"/>
		</StackPanel>

		<StackPanel Margin="10,20,0,0" Grid.Row="3" Grid.Column="0" Orientation="Horizontal" ToolTip="Add Folder">
			<Button HorizontalContentAlignment="Left" Command="{Binding AddFolderCommand}">
				<StackPanel Orientation="Horizontal">
					<Image Source="../Resources/AddFolder.ico" Width="15" Height="15"></Image>
					<TextBlock FontSize="12" FontFamily="Calibri" Margin="5,0,0,0" Text="AddFolder"/>
				</StackPanel>
			</Button>

			<Button HorizontalContentAlignment="Left" Command="{Binding AddTmCommand}" ToolTip="Add TMs">
				<StackPanel Orientation="Horizontal">
					<Image Source="../Resources/PlusSign.ico" Width="15" Height="15"></Image>
					<TextBlock FontSize="12" FontFamily="Calibri" Margin="5,0,0,0" Text="AddTMs"/>
				</StackPanel>
			</Button>

			<Button HorizontalContentAlignment="Left" Command="{Binding RemoveTMsCommand}" ToolTip="Remove TMs">
				<StackPanel Orientation="Horizontal">
					<Image Source="../Resources/Remove.ico" Width="15" Height="15"></Image>
					<TextBlock FontSize="12" FontFamily="Calibri" Margin="5,0,0,0" Text="RemoveTMs"/>
				</StackPanel>
			</Button>
		</StackPanel>

		<DataGrid  Grid.Row="4" Grid.Column="0" Grid.ColumnSpan="2" ItemsSource="{Binding TmCollection, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
		           IsReadOnly="True"
		           SelectionMode="Extended"
		           AutoGenerateColumns="False"
		           SelectionUnit="FullRow"
		           Margin="10,0,10,10"
				   VerticalScrollBarVisibility="Auto"
		           CanUserAddRows="False"
		           AllowDrop="True"
		           utilities:DropBehavior.PreviewDropCommand="{Binding DragEnterCommand}">

			<DataGrid.RowStyle>
				<Style TargetType="DataGridRow" BasedOn="{StaticResource DgrStyle}" />
			</DataGrid.RowStyle>

			<DataGrid.Resources>
				<Style TargetType="{x:Type DataGridColumnHeader}" BasedOn="{StaticResource DgcHeaderStyle2}" />
			</DataGrid.Resources>

			<DataGrid.Columns>
				<DataGridTemplateColumn Width="Auto" MinWidth="50">

					<DataGridTemplateColumn.Header>
						<CheckBox HorizontalContentAlignment="Left" IsChecked="{Binding Path=DataContext.AllTmsChecked, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Window}}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"  Content="Use">
							<CheckBox.Style>
								<Style TargetType="CheckBox" BasedOn="{StaticResource {x:Type CheckBox}}">
									<Setter Property="Foreground" Value="White"></Setter>
								</Style>
							</CheckBox.Style>
						</CheckBox>
					</DataGridTemplateColumn.Header>

					<DataGridTemplateColumn.CellTemplate>
						<DataTemplate>
							<CheckBox Margin="1,0,0,0" HorizontalAlignment="Left" IsChecked="{Binding IsSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
						</DataTemplate>
					</DataGridTemplateColumn.CellTemplate>
				</DataGridTemplateColumn>

				<DataGridTemplateColumn Width="*" Header="TM Name">
					<DataGridTemplateColumn.CellTemplate>
						<DataTemplate>
							<StackPanel Orientation="Horizontal" Margin="60,0,0,0">
								<Image Source="{Binding Icon}" Width="25" Height="25" HorizontalAlignment="Center" />
								<TextBlock Text="{Binding Name}" Margin="5" HorizontalAlignment="Left" />
							</StackPanel>
						</DataTemplate>
					</DataGridTemplateColumn.CellTemplate>
				</DataGridTemplateColumn>

				<DataGridTemplateColumn Width="*" Header="Template applied">
					<DataGridTemplateColumn.CellTemplate>
						<DataTemplate>
							<StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
								<TextBlock Text="Source" Margin="0,0,10,0" />
								<Image Source="{Binding SourceStatus, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="15" Height="15" ToolTip="{Binding SourceStatusToolTip}" Margin="0,0,10,0" />
								<TextBlock Text="Target" Margin="0,0,10,0" />
								<Image Source="{Binding TargetStatus, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="15" Height="15" ToolTip="{Binding TargetStatusToolTip}" />
							</StackPanel>
						</DataTemplate>
					</DataGridTemplateColumn.CellTemplate>
				</DataGridTemplateColumn>
			</DataGrid.Columns>
		</DataGrid>
		<StackPanel Grid.Row="5" Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
			<controls:ProgressRing Visibility="{Binding ProgressVisibility}" Width="30" />

			<Button IsEnabled="{Binding CanExecuteApply, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource SdlWizardStyleButtonGreen}" RenderTransformOrigin="0.487,1.938" HorizontalAlignment="Right" Margin="0,10,10,0" Command="{Binding ApplyTemplateCommand}" Content="Apply: Template -> TMs" ToolTip="{x:Static applyTmTemplate:PluginResources.Apply_button_Tooltip}" />
		</StackPanel>
	</Grid>
</controls:MetroWindow>