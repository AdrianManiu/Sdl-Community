<Window x:Class="InterpretBank.SettingsService.UI.GlossarySetup"
		xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
		xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
		xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
		xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
		xmlns:sdl="http://schemas.sdl.com/xaml"
		WindowStartupLocation="CenterScreen"
		xmlns:viewModel="clr-namespace:InterpretBank.SettingsService.ViewModel"
		xmlns:ui="clr-namespace:InterpretBank.SettingsService.UI"
		xmlns:interpretBank="clr-namespace:InterpretBank"
		xmlns:converters="clr-namespace:InterpretBank.SettingsService.Converters"
		xmlns:model="clr-namespace:InterpretBank.SettingsService.Model"
		d:DataContext="{d:DesignInstance viewModel:GlossarySetupViewModel}"
		SizeToContent="Height"
		mc:Ignorable="d"
		MaxHeight="1000"
		Width="600">
	<Window.Resources>
		<ResourceDictionary>
			<ResourceDictionary.MergedDictionaries>
				<ResourceDictionary Source="../Styles/SettingsResources.xaml" />
				<ResourceDictionary Source="/Sdl.Desktop.Platform.Styles;component/ButtonResources.xaml" />
				<ResourceDictionary Source="/Sdl.Desktop.Platform.Styles;component/comboboxresources.xaml" />
				<ResourceDictionary Source="/Sdl.Desktop.Platform.Styles;component/datagridresources.xaml" />
				<ResourceDictionary Source="../Styles/SetupGlossariesResources.xaml" />
			</ResourceDictionary.MergedDictionaries>
			<converters:NullToVisibilityConverter x:Key="NullToVisibilityConverter" />
			<converters:IntToBoolConverter x:Key="IntToBoolConverter" />
		</ResourceDictionary>
	</Window.Resources>
	<Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto" />
			<RowDefinition Height="Auto" />
			<RowDefinition Height="*" />
			<RowDefinition Height="Auto" />
		</Grid.RowDefinitions>
		<Image Grid.Row="0"
		       Height="50"
		       Source="../../Resources/logo.png" />
		<DockPanel Grid.Row="1"
				   HorizontalAlignment="Stretch"
				   Margin="10 10 10 5"
				   VerticalAlignment="Top">

			<TextBlock Text="{x:Static interpretBank:PluginResources.SettingsWindow_TextBlock_DBFilepath}"
					   DockPanel.Dock="Top" />
			<ui:ChooseFilepathControl />
		</DockPanel>
		<TabControl Margin="10"
					Visibility="{Binding Filepath, Converter={StaticResource NullToVisibilityConverter}}"
					Grid.Row="2"
					Background="#F6F6F6"
					BorderThickness="1">
			<TabItem Header="Glossaries"
					 Template="{StaticResource GlossarySetupTabItem}">
				<Grid>
					<Grid.RowDefinitions>
						<RowDefinition Height="Auto" />
						<RowDefinition Height="*" />
					</Grid.RowDefinitions>
					<Grid.ColumnDefinitions>
						<ColumnDefinition />
						<ColumnDefinition />
					</Grid.ColumnDefinitions>

					<DockPanel LastChildFill="False"
							   Grid.Column="0"
							   Grid.ColumnSpan="2"
							   Grid.Row="0"
							   DockPanel.Dock="Left">
						<TextBox x:Name="ValueHolder"
								 Visibility="Collapsed" />
						<TextBlock Text="Type in a new glossary name then press enter:"
								   Margin="0 5 0 1"
								   DockPanel.Dock="Top" />
						<TextBox DockPanel.Dock="Top"
								 Margin="0 0 0 5"
								 PreviewKeyDown="UIElement_OnKeyDown">
							<TextBox.InputBindings>
								<KeyBinding Key="Enter"
											Command="{Binding EnterGlossaryCommand}"
											CommandParameter="{Binding Text, ElementName=ValueHolder}" />
							</TextBox.InputBindings>
						</TextBox>
					</DockPanel>

					<ListBox DockPanel.Dock="Top"
							 Grid.Column="0"
							 Grid.Row="1"
							 x:Name="GlossaryList"
							 Validation.ErrorTemplate="{x:Null}"
							 ItemsSource="{Binding Glossaries}"
							 SelectedItem="{Binding GlossarySetupSelectedGlossary}"
							 d:ItemsSource="{d:SampleData ItemCount=5}">
						<ListBox.ItemTemplate>
							<DataTemplate>
								<DockPanel>
									<Image Source="../../Resources/Glossary.png"
										   DockPanel.Dock="Left"
										   Height="17" />
									<TextBlock Text="{Binding GlossaryName}"
											   FontSize="10"
											   VerticalAlignment="Center"
											   DockPanel.Dock="Left" />
								</DockPanel>
							</DataTemplate>
						</ListBox.ItemTemplate>
					</ListBox>
					<Grid Grid.Column="1"
						  Grid.Row="1">
						<Grid.RowDefinitions>
							<RowDefinition Height="*" />
							<RowDefinition Height="*" />
						</Grid.RowDefinitions>

						<DockPanel>
							<Label Content="Languages"
								   Padding="5 0 0 5"
								   DockPanel.Dock="Top"
								   FontWeight="Light"
								   FontSize="10" />
							<sdl:MultiSelectComboBox DockPanel.Dock="Bottom"
													 Margin="5 0 0 5"
													 ItemsSource="{Binding Languages}"
													 SelectedItems="{Binding SelectedItem.Languages, ElementName=GlossaryList, Mode=TwoWay}"
													 DropdownItemTemplate="{StaticResource LanguageTemplate}"
													 SelectedItemTemplate="{StaticResource LanguageTemplate}" />
						</DockPanel>
						<DockPanel Grid.Row="1">
							<Label DockPanel.Dock="Top"
								   Content="Tags"
								   Padding="5 0 0 5"
								   FontWeight="Light"
								   FontSize="10" />
							<sdl:MultiSelectComboBox Grid.Row="3"
													 DockPanel.Dock="Bottom"
													 Margin="5 0 0 0"
													 ItemsSource="{Binding Tags}"
													 SelectedItems="{Binding SelectedItem.Tags, ElementName=GlossaryList}"
													 DropdownItemTemplate="{StaticResource TagTemplate}"
													 SelectedItemTemplate="{StaticResource TagTemplate}" />
						</DockPanel>
					</Grid>
				</Grid>
			</TabItem>

			<!--Tags tab-->
			<TabItem Header="Tags"
					 Template="{StaticResource GlossarySetupTabItem}">
				<Grid>
					<Grid.RowDefinitions>
						<RowDefinition Height="Auto" />
						<RowDefinition Height="*" />
					</Grid.RowDefinitions>
					<Grid.ColumnDefinitions>
						<ColumnDefinition />
						<ColumnDefinition />
					</Grid.ColumnDefinitions>

					<DockPanel LastChildFill="False"
							   Grid.Row="0"
							   Grid.Column="0"
							   Grid.ColumnSpan="2">
						<TextBlock Text="Type in a new tag then press enter:"
								   Margin="0 5 0 1"
								   DockPanel.Dock="Top" />
						<TextBox DockPanel.Dock="Top"
								 Margin="0 0 0 5"
								 PreviewKeyDown="UIElement_OnKeyDown">
							<TextBox.InputBindings>
								<KeyBinding Key="Enter"
											Command="{Binding EnterTagCommand}"
											CommandParameter="{Binding Text, ElementName=ValueHolder}" />
							</TextBox.InputBindings>
						</TextBox>
					</DockPanel>

					<ListBox DockPanel.Dock="Top"
							 Grid.Row="1"
							 x:Name="TagsList"
							 Grid.Column="0"
							 ItemsSource="{Binding Tags}"
							 SelectedItem="{Binding SelectedTag}"
							 d:ItemsSource="{d:SampleData ItemCount=5}">
						<ListBox.ItemTemplate>
							<DataTemplate>
								<DockPanel>
									<Button Command="{Binding DataContext.DeleteTagCommand, RelativeSource={RelativeSource AncestorType=ListBox}}"
											CommandParameter="{Binding TagName}"
											VerticalAlignment="Center"
											DockPanel.Dock="Left"
											Content="&#xE106;">
										<Button.Template>
											<ControlTemplate TargetType="Button">
												<TextBlock FontFamily="Segoe MDL2 Assets"
														   Text="{TemplateBinding Content}"
														   Foreground="Red"
														   HorizontalAlignment="Right"
														   FontSize="7" />
											</ControlTemplate>
										</Button.Template>
									</Button>
									<Image Source="../../Resources/Tag.png"
										   DockPanel.Dock="Left"
										   Height="17" />
									<TextBlock Text="{Binding TagName}"
											   FontSize="10"
											   VerticalAlignment="Center"
											   DockPanel.Dock="Right" />
								</DockPanel>
							</DataTemplate>
						</ListBox.ItemTemplate>
					</ListBox>


					<sdl:MultiSelectComboBox Grid.Column="1"
											 Grid.Row="1"
											 Margin="5 0 0 0"
											 ItemsSource="{Binding Glossaries}"
											 DropdownItemTemplate="{StaticResource GlossaryTemplate}"
											 SelectedItems="{Binding GlossariesTaggedWithSelected}"
											 SelectedItemTemplate="{StaticResource GlossaryTemplate}" />
				</Grid>
			</TabItem>

			<TabItem Header="Languages"
					 Template="{StaticResource GlossarySetupTabItem}">

				<Grid>
					<Grid.RowDefinitions>
						<RowDefinition Height="*" />
						<RowDefinition Height="Auto" />
					</Grid.RowDefinitions>

					<DataGrid ItemsSource="{Binding SelectedLanguages}"
							  Grid.Row="0"
							  AutoGenerateColumns="False"
							  Style="{StaticResource Sdl.DataGrid.GenericStyle}"
							  SelectionMode="Single"
							  IsReadOnly="True">
						<DataGrid.Columns>
							<DataGridTemplateColumn Width="*">
								<DataGridTemplateColumn.CellTemplate>
									<DataTemplate>
										<ComboBox ItemsSource="{Binding LanguageModels}"
												  SelectedIndex="{Binding SelectedIndex, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
												  Style="{StaticResource Sdl.ComboBox.Generic.Style}"
												  ItemTemplate="{StaticResource LanguageTemplate}"
												  IsEnabled="{Binding SelectedIndex, Converter={StaticResource IntToBoolConverter}}" />
									</DataTemplate>
								</DataGridTemplateColumn.CellTemplate>
							</DataGridTemplateColumn>
						</DataGrid.Columns>
					</DataGrid>
					<Button Content="Commit to database"
							Grid.Row="1"
							Cursor="Hand"
							Width="Auto"
							Height="30"
							Style="{StaticResource Sdl.Button.GeneralStyle}"
							HorizontalAlignment="Right"
							Margin="0 10 0 0" />

				</Grid>

				<!--<ListBox ItemsSource="{Binding SelectedLanguages}" HorizontalAlignment="Left">
					<ListBox.ItemTemplate>
						<DataTemplate>
							<ComboBox ItemTemplate="{StaticResource LanguageTemplate}"
							          ItemsSource="{Binding LanguageModels}"/>
						</DataTemplate>
					</ListBox.ItemTemplate>
				</ListBox>-->

			</TabItem>

		</TabControl>
		<DockPanel Grid.Row="3"
				   Margin="0 10 0 0"
				   VerticalAlignment="Bottom"
				   LastChildFill="False">
			<Button Content="Cancel"
					Cursor="Hand"
					Width="120"
					IsCancel="True"
					Height="30"
					Style="{StaticResource Sdl.Button.SecondaryStyle}"
					DockPanel.Dock="Right"
					Margin="0 0 10 10" />

			<Button Content="Apply changes"
					Cursor="Hand"
					Width="120"
					Click="ButtonBase_OnClick"
					Command="{Binding SaveCommand}"
					Height="30"
					Style="{StaticResource Sdl.Button.PrimaryStyle}"
					DockPanel.Dock="Right"
					Margin="0 0 10 10" />
		</DockPanel>
	</Grid>
</Window>
